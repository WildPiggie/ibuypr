<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    {% block title %}
    <title>iBuy</title>
    {% endblock %}

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="{% static 'ibuy/scripts.js' %}"/>
    </script>
    <link rel="stylesheet" type="text/css" href="{% static 'ibuy/style.css' %}"/>
    <script src="https://kit.fontawesome.com/56015711c9.js" crossorigin="anonymous"></script>
    <meta name="viewport" content="initial-scale=1">
</head>
<body>
<section class="page-wrap">

    <header>

        <section class="open-sidebar-btn">
            <a href="#" id="menu-btn">
                <i class="fa fa-bars" aria-hidden="true"></i>
            </a>
        </section>

        <section class="sidebar">
            <a href="#" id="close-sidebar-btn">
                <i class="fa fa-times" aria-hidden="true"></i>
            </a>

            <p class="sidebar-user">
                Olá,
                {% if request.user.is_authenticated %}
                <a href="{% url 'ibuy:perfil' request.user.id %}">{{ request.user.first_name }}</a>!
                {% else %}
                <a href="{% url 'ibuy:loginuser' %}">LogIn</a>
                {% endif %}
            </p>

            <hr>

            <section class="sidebar-btns">
                <a href="{% url 'ibuy:index' %}">Home
                    <section class="sidebar-btns-symbols"><i class="fa-solid fa-house"></i></section>
                </a>
                <a class="sidebar-dropdown-btn" id="category">
                    Categorias
                    <section class="sidebar-btns-symbols"><i id="category-symbol" class="fa-solid fa-angle-right"></i>
                    </section>
                </a>
                <section class="sidebar-dropdown-container">
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-list"></i>Tudo</a>
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-shirt"></i>Roupa</a>
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-book"></i>Livros</a>
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-marker"></i>Escrita</a>
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-house-chimney-window"></i>Casa</a>
                    <a href="#" class="sidebar-dropdown-option"><i class="fa-solid fa-hammer"></i>Outros</a>

                </section>
                <a href="{% url 'ibuy:carrinho' %}">Carrinho
                    <section class="sidebar-btns-symbols"><i class="fa-solid fa-cart-shopping"></i></section>
                </a>

                {% if request.user.is_authenticated and not request.user.is_superuser %}
                <a href="{% url 'ibuy:meusprodutos' %}">Meus Produtos
                    <section class="sidebar-btns-symbols"><i class="fa-solid fa-cubes"></i></section>
                </a>
                <a href="{% url 'ibuy:criarproduto' %}">Criar Produto
                    <section class="sidebar-btns-symbols"><i class="fa-regular fa-square-plus"></i></section>
                </a>
                {% endif %}

            </section>
        </section>

        <section class="logo">
            <a href="{% url 'ibuy:index' %}"><img src="{% static 'ibuy/images/LOGO-IBUY-White-Trans.gif' %}"
                                                  alt="Logo iBuy" height="50"></a>
        </section>

        <section class="search">
            <i id="search-symbol" class="fa-solid fa-magnifying-glass fa-xl"></i>
            <form method="post" id="search-form">
                {% csrf_token %}
                <input id="search-text" name="texto-pesquisa" type="text" placeholder="Pesquisar...">
            </form>
        </section>

        <section class="header-btns">

            {% if request.user.is_authenticated %}
            <a href="{% url 'ibuy:logoutview' %}"><i class="fa-solid fa-arrow-right-from-bracket" id="logout-btn"></i>Log
                out</a>
            <a href="{% url 'ibuy:minhaconta' %}"><i class="fa-solid fa-user"></i></i>Conta</a>
            {% else %}
            <a href="{% url 'ibuy:loginuser' %}"><i class="fa-solid fa-arrow-right-to-bracket"></i>LogIn</a>
            {% endif %}
            <a href="{% url 'ibuy:carrinho' %}"><i class="fa-solid fa-cart-shopping"></i>Carrinho</a>
            <section class="credit">
                <img src="{% static 'ibuy/images/coin.png' %}" alt="Moeda do website" width="30" height="30"
                     id="img-coin">
                {% if request.user.is_authenticated %}
                {{ request.user.utilizador.credito }}
                {% else %}
                0
                {% endif %}
            </section>
        </section>
    </header>

    <section id="overlay"></section>

    <section class="content-wrap">
        {% block content %}

        <section class="filter">
            <form method="post" id="filter-form">
                {% csrf_token %}
                <select id="categoria" name="categoria" onchange="this.form.submit()">
                    <option value="" selected disabled hidden>Filtrar por...</option>
                    <option value="Tudo">Tudo</option>
                    <option value="Roupa">Roupa</option>
                    <option value="Livros">Livros</option>
                    <option value="Escrita">Escrita</option>
                    <option value="Casa">Casa</option>
                    <option value="Outros">Outros</option>
                </select>
            </form>
        </section>

        {% if lista_produtos %}
        <h2>{{ titulo }}</h2>
        {% for produto in lista_produtos %}
        <a href="{% url 'ibuy:produto' produto.id %}">
            <section style="cursor: pointer;" class="index-product-wrap" id="{{ produto.id }}">
                <a href="{% url 'ibuy:produto' produto.id %}">
                    <section class="index-product-img">
                        <img src="{% static 'media/images/produto/' %}{{ produto.imagem }}" alt="Produto"
                             id="img-produto">
                    </section>
                </a>

                <section class="index-product-details-wrap">

                    <section class="index-product-name">
                        <a href="{% url 'ibuy:produto' produto.id %}">
                            {{ produto.nome }}
                        </a>
                    </section>
                    <section class="index-product-username">
                        <a href="{% url 'ibuy:perfil' produto.user.id %}">
                            <i class="fa-solid fa-user"></i>{{ produto.user.username }}
                        </a>
                    </section>
                    <section class="index-product-likes"><i class="fa-solid fa-thumbs-up"></i>{{ produto.total_likes }}
                    </section>
                    <section class="index-product-state">Condição: {{ produto.condicao }}
                    </section>
                    <section class="index-product-quantity">Stock: {{ produto.quantidade }} unidade{{ produto.quantidade|pluralize }}
                    </section>
                    <section class="index-product-price"><img src="{% static 'ibuy/images/coin.png' %}"
                                                              alt="Moeda do website" width="30" height="30">  {{ produto.preco }}
                    </section>

                    {% if user.is_superuser %}

                    <section class="admin-index-product-options">
                        <a href="{% url 'ibuy:alterarproduto' produto.id %}">
                            <i class="fa-solid fa-pen-to-square fa-2xl"></i>
                        </a>
                        <a href="{% url 'ibuy:apagarproduto' produto.id %}">
                            <i class="fa-solid fa-trash fa-2xl"></i>
                        </a>
                    </section>

                    {% endif %}


                </section>
            </section>
        </a>

        {% endfor %}
        <br><br>

        {% else %}
        <p>Nao existem produtos.</p>
        {% endif %}

        {% endblock %}
    </section>

    <footer>
        <section class="upper-footer-wrap">
            <section class="upper-footer-wrap-content">
                <section class="upper-footer-wrap-left">
                    <section class="upper-footer-wrap-left-text">
                        <h4>Contactos</h4>
                        <p><i class="fa-solid fa-phone"></i>+351 212 698 364</p>
                        <p><i class="fa-regular fa-envelope"></i>ibuy@business.com</p>
                    </section>
                </section>
                <section class="vertical-line"></section>
                <section class="upper-footer-wrap-mid">
                    <section class="upper-footer-wrap-mid-text">
                        <h4>Sobre a iBuy</h4>
                        <p><a href="{% url 'ibuy:historiaempresa' %}" target="_blank">História da empresa</a></p>
                        <p><a href="" target="_blank">A nossa moeda</a></p>
                        <p><a href="" target="_blank">Onde estamos</a></p>
                    </section>
                </section>
                <section class="vertical-line"></section>
                <section class="upper-footer-wrap-right">
                    <section class="upper-footer-wrap-right-text">
                        <h4>Redes sociais</h4>
                        <a href="https://m.facebook.com/samco2k?_rdr" target="_blank"><i
                                class="fa-brands fa-facebook-f"></i> Facebook</a><br>
                        <a href="https://www.instagram.com/opombosilva/" target="_blank"><i
                                class="fa-brands fa-instagram"></i> Instagram</a><br>
                        <a href="https://twitter.com/uhfonso" target="_blank"><i class="fa-brands fa-twitter"></i>
                            Twitter</a><br>
                    </section>
                </section>
            </section>
        </section>
        <section class="lower-footer-wrap">
            <p>Olga Silva | Samuel Correia | Afonso Sampaio</p>
            <p>&copy; 2022, iBuy. Todos os direitos reservados.</p>
        </section>
    </footer>

</section>

</body>
</html>